<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Admin Panel | Vastra Tara</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="container mt-4">

<h2 class="mb-3">Admin Panel – Vastra Tara</h2>

<div class="d-flex justify-content-between mb-3">
    <span class="text-muted">Add products, colours & images</span>
    <a href="/admin/logout" class="btn btn-outline-danger btn-sm">Logout</a>
</div>

<!-- ================= ADD PRODUCT ================= -->
<div class="card mb-4">
    <div class="card-body">

        <h5 class="mb-3">Add New Product</h5>

        <form method="post">

            <div class="row g-2 mb-2">
                <!-- PRODUCT NAME -->
                <div class="col-md-3">
                    <input
                        class="form-control"
                        name="name"
                        placeholder="Product Name"
                        required
                    >
                </div>

                <!-- PRICE -->
                <div class="col-md-2">
                    <input
                        class="form-control"
                        name="price"
                        type="number"
                        min="1"
                        placeholder="Price"
                        required
                    >
                </div>

                <!-- QUANTITY -->
                <div class="col-md-2">
                    <input
                        class="form-control"
                        name="quantity"
                        type="number"
                        min="0"
                        placeholder="Quantity"
                        required
                    >
                </div>

                <!-- DESCRIPTION -->
                <div class="col-md-5">
                    <textarea
                        class="form-control"
                        name="description"
                        placeholder="Product Description"
                        rows="2"
                        required
                    ></textarea>
                </div>
            </div>

            <button class="btn btn-dark mt-2">
                Create Product
            </button>

        </form>

    </div>
</div>

<!-- ================= ADD COLOUR + IMAGES ================= -->
<div class="card mb-4">
    <div class="card-body">

        <h5 class="mb-3">Add Colour & Images (All Angles)</h5>

        <form method="post" enctype="multipart/form-data" action="/admin/add-images">

            <div class="row g-2 mb-2">

                <div class="col-md-4">
                    <select class="form-control" name="product_id" required>
                        <option value="">Select Product</option>
                        {% for p in products %}
                            <option value="{{ p[0] }}">{{ p[1] }}</option>
                        {% endfor %}
                    </select>
                </div>

                <div class="col-md-3">
                    <input
                        class="form-control"
                        name="color"
                        placeholder="Colour (e.g. Red, Blue)"
                        required
                    >
                </div>

                <div class="col-md-3">
                    <input
                        type="file"
                        class="form-control"
                        name="images"
                        accept="image/*"
                        multiple
                        required
                    >
                </div>

                <div class="col-md-2">
                    <button class="btn btn-success w-100">
                        Upload
                    </button>
                </div>

            </div>

            <small class="text-muted">
                Upload multiple images (front, back, side) for one colour
            </small>

        </form>

    </div>
</div>

<!-- ================= PRODUCT LIST ================= -->
<h5 class="mb-3">Products</h5>

<table class="table table-bordered table-hover">
    <thead class="table-dark">
        <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Price</th>
            <th>Qty</th>
            <th>Description</th>
            <th>Action</th>
        </tr>
    </thead>

    <tbody>
    {% for p in products %}
        <tr>
            <td>{{ p[0] }}</td>
            <td>{{ p[1] }}</td>
            <td>₹ {{ p[2] }}</td>

            <!-- QUANTITY DISPLAY -->
            <td>
                {% if p[4] > 0 %}
                    <span class="badge bg-success">{{ p[4] }}</span>
                {% else %}
                    <span class="badge bg-danger">Out</span>
                {% endif %}
            </td>

            <!-- DESCRIPTION -->
            <td style="max-width:300px;">
                {% if p[3] %}
                    {{ p[3][:120] }}{% if p[3]|length > 120 %}...{% endif %}
                {% else %}
                    <span class="text-muted">No description</span>
                {% endif %}
            </td>

            <!-- ACTION -->
            <td>
                <a
                    href="/delete/{{ p[0] }}"
                    class="btn btn-danger btn-sm"
                    onclick="return confirm('Delete this product and all its images?')"
                >
                    Delete
                </a>
            </td>
        </tr>
    {% endfor %}
    </tbody>
</table>

</body>
</html>
